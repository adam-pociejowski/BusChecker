
<div xmlns:th="http://www.w3.org/1999/xhtml" ng-init="init()">
    <div>
        <nav class="navbar navbar-default navbar-fixed-top">
            <div class="container-fluid">
                <div class="navbar-header">
                    <a class="navbar-brand">Bus Checker</a>
                </div>

                <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                    <ul class="nav navbar-nav">
                        <li class="dropdown">
                            <a class="dropdown-toggle" data-toggle="dropdown">Twoi kierowcy<span class="caret"></span></a>
                            <ul class="dropdown-menu">
                                <li ng-repeat="driver in data.drivers"><a ng-click="choseDriver(driver)">{{driver.firstname}} {{driver.lastname}}</a></li>
                            </ul>
                        </li>
                        <li><a ng-click="getOtherDrivers()" data-toggle="modal" data-target="#addDriverModal">Dodaj kierowców</a></li>
                    </ul>

                    <form class="navbar-form navbar-right">
                        <button ng-click="logout()" type="submit" class="btn btn-primary">Wyloguj się</button>
                    </form>
                    <p class="navbar-text navbar-right">Zalogowany jako: {{loggedUser}}</p>
                </div>
            </div>
        </nav>
    </div>

    <div class="container">
        <div ng-if="data.drivers.length == 0">
            <span>
                Nie masz dodanych jeszcze żadnych kierowców, możesz to zrobić
                wybierając z menu -> Kierowcy -> Dodaj kierowcę
            </span>
        </div>
        <div class="row col-md-10 col-md-offset-1" ng-if="data.drivers.length > 0">
            <div class="checker-header">
                <span class="checker-driver">Aktywny kierowca: {{chosenDriver.firstname}} {{chosenDriver.lastname}}</span>
                <a ng-click="deleteDriverFromUser()" class="glyphicon glyphicon-remove-sign"
                   style="font-size: 1.5em; color: red;margin-left: 30px;"></a>
            </div>

            <div class="checker-panel">
                <span class="checker-panel-header">Szczegóły wozu</span>
                <table class="table table-striped table-hover">
                    <tbody>
                        <tr ng-repeat="obj in infos">
                            <td class="col-md-4">{{obj.label}}</td>
                            <td class="col-md-7">{{obj.value}}</td>
                            <td class="col-md-1">
                                <button type="button" ng-click="edit(obj)" class="btn btn-primary" data-toggle="modal" data-target="#modal">
                                    <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                                </button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="checker-panel">
                <span class="checker-panel-header">Przeglądy oraz ubezpieczenie</span>
                <table class="table table-striped table-hover">
                    <tbody>
                    <tr ng-repeat="obj in dates">
                        <td class="col-md-5">{{obj.label}}</td>
                        <td class="col-md-3">
                            <div class="form-group input-group date" data-provide="datepicker">
                                <input ng-model="obj.value" ng-model="acc.insuranceDate" type="text" class="form-control">
                                <div class="input-group-addon"><span class="glyphicon glyphicon-th"></span></div>
                            </div></td>
                        <td class="col-md-3" style="margin-left: 20px;">
                            {{nextReview(obj)}}
                        </td>
                        <td class="col-md-1">
                            <button type="button" ng-click="save()" class="btn btn-primary">
                                <span class="glyphicon glyphicon-save" aria-hidden="true"></span>
                            </button>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>

            <div class="checker-panel">
                <span class="checker-panel-header">Opiekunowie</span>
                <table class="table table-striped table-hover">
                    <tbody>
                        <tr ng-repeat="obj in sitters">
                            <td class="col-md-11">{{obj.value}}</td>
                            <td class="col-md-1">
                                <button type="button" ng-click="editSitter(obj)" class="btn btn-primary" data-toggle="modal" data-target="#modal">
                                    <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                                </button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div style="margin-top: 150px;" class="modal fade" id="addDriverModal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header bg-primary">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">Dodawanie kierowców</h4>
                </div>
                <div class="modal-body">
                    <div>Zaznacz kierowców, których chcesz dodać z listy lub dodaj nowego:</div>
                    <div ng-if="addingNewDriver == false">
                        <div ng-repeat="driver in otherDrivers" style="margin: 10px;">
                            <input ng-model="driver.chosen" type="checkbox" />
                            <span style="margin-left: 10px;">{{driver.firstname}} {{driver.lastname}}</span>
                        </div>
                        <button ng-click="setAddingDriver(true)" class="btn btn-success btn-circle btn-lg glyphicon glyphicon-plus"></button>
                    </div>

                    <div ng-if="addingNewDriver == true">
                        <table style="margin-top: 20px;">
                            <tr>
                                <td style="padding-right: 20px;">
                                    <div class="form-group">
                                        <div>Imię</div>
                                        <input ng-model="newDriver.firstname" type="text" />
                                    </div>
                                </td>
                                <td>
                                    <div class="form-group">
                                        <div>Nazwisko</div>
                                        <input ng-model="newDriver.lastname" type="text" />
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="form-group">
                                        <div>Telefon</div>
                                        <input ng-model="newDriver.phoneNumber" type="number" />
                                    </div>
                                </td>
                                <td>
                                    <div class="form-group">
                                        <div>Email</div>
                                        <input ng-model="newDriver.email" type="email" />
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="form-group">
                                        <div>Powiadomienie dni wczęśniej</div>
                                        <input ng-init="newDriver.notificationBefore=14" ng-model="newDriver.notificationBefore" type="number" />
                                    </div>
                                </td>
                            </tr>
                        </table>
                        <input type="hidden" ng-init="newDriver.chosen=true" />
                        <button ng-click="addNewDriver()" class="btn btn-primary">Dodaj kierowcę</button>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger" ng-click="clearNewDriver()" data-dismiss="modal">Anuluj</button>
                    <button type="button" class="btn btn-primary" ng-click="saveDrivers()" data-dismiss="modal">Zapisz</button>
                </div>
            </div>
        </div>
    </div>


    <div style="margin-top: 150px;" class="modal fade" id="modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel">Ustaw wartość pola: '{{editingObj.label}}'</h4>
                </div>
                <div class="modal-body">
                    <input class="col-md-12" type="text" id="modalInput" ng-model="modalInput"/>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Zamknij</button>
                    <button type="button" class="btn btn-primary" ng-click="save()" data-dismiss="modal">Zapisz</button>
                </div>
            </div>
        </div>
    </div>
</div>